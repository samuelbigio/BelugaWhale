<!DOCTYPE html>
<html>
<style>



#myAnimation {

  width: 456px;
  height: 624px;
  position: absolute;

  
}


#myAnimationWhale {

width: 753px;
height: 1530px;
position: absolute;


}

#bareSam {
  background-image: url(baresam.png);
  width: 100%;
  height: 100%;
}







#myContainer {
  width: auto;
  height: auto;
  position: relative;

  
}

div
{
cursor:   url(cursor1.cur),auto;
            
}

</style>

<body>



<p>
  <button onclick="musicPlay()">Play</button>
  <button onclick="musicPause()">Pause</button> 

  <button onclick="musicStop()">Stop</button> 
</p>


<div id ="myContainer">
  <div id ="myAnimation">
    <div id="bareSam">

    </div>  
  </div>
</div>




<script>

  sidePos =0
  UpPos=0
  baresameWidth = 456
  baresameHeight = 624


  whaleWidth = 753
  whaleHeight = 1530

  speed = 40

  whaleHeight = 1530
  whaleWidth = 753
  speed = 40
  playFlag = 0
  var initFlag=0
  scale_factor= .25
  var count =0
  //Todo: Make a point to check if  auido.currentTime is past the intro to change speed/style
  // if in breakdown of the song.

  
  var barewhaleImg = new Image();
  barewhaleImg.onload = function(){
    
    barewhaleImg.src = this.src
    
      barewhaleImg.height = whaleHeight * scale_factor
      barewhaleImg.width = whaleWidth * scale_factor
      count +=1

      // Can you figure out why this is called more than once? How many times is the 
      // image loaded? every tick?
      console.log(count)


      document.body.appendChild(barewhaleImg)
  }
  

  
  

  function init()
  {

    barewhaleImg.src = "barewhale.png"
    initFlag=1
  }






  // global variables to maintain
  // the direction the whale is going in
  // defaults to going down and to the right
  whaleUpDirection = 1
  whaleSideDirection = 1

  // set element values for whale
  //var whaleElem = barewhaleImg  -> i replaced your code with my gloabal.
  barewhaleImg.style.top = 0 + "px"
  barewhaleImg.style.left = 0 + "px"

  var audio = new Audio('music.mp3');
  function musicPause(){
    audio.pause()
    playFlag=0
    

    }
 

  function musicStop(){
    var elem = document.getElementById("myAnimation");   
    elem.style.top = 0 + 'px'; 
    elem.style.left = 0+ 'px';
    sidePos=0
    UpPos=0
    audio.pause()
    audio.currentTime=0
  }
  

  function musicPlay(){
    audio.play();
    if (playFlag == 0)
      playFlag=1
      
    }


  
  window.addEventListener("keydown", moveSomething, false);
  
  /*
    moveWhale: moves whale diagnoally (for example both 
    up and left)

    When whale hits the edge of the container it goes in the other
    direction (for instance if the whale hits the left edge it will
    start going right)

    *******************************************************************
    Hey jose, This isn't working anymore can you look at it and see why it doesn't work.
    The only thing i changed was "var elem = barewhaleImg"

    Also, I am going to add a random element to not just make the whale bounce off the walls
    in the same pattern. I think the deflection is good but soon i am going to try and 
    make the whale avoid the animation of naked boy to avoid it slowly.
    

  */
  function moveWhale() {


    //Should grab the global
    var elem = barewhaleImg

    leftPos =  parseInt(elem.style.left, 10);
    topPos =  parseInt(elem.style.top, 10);

    console.log("Parsing left element")
    console.log(leftPos)
    
    // calculate positions
    newLeftPos = whaleSideDirection *speed + leftPos;
    newTopPos = whaleUpDirection *speed + topPos;

    console.log("New left position is")
    console.log(newLeftPos)

    // update the positions with a check for out of bounds
    if (newLeftPos + whaleWidth < 0) {
        elem.style.left = 0 + "px";
        whaleSideDirection *= -1
    } else if ( newLeftPos > whaleWidth ) {
        elem.style.left = whaleWidth + "px"
        whaleSideDirection *= -1
    } else {
      elem.style.left = newLeftPos + "px"
    }

    if (newTopPos + whaleHeight < 0) { 
      elem.style.top = 0 + "px"
      whaleUpDirection *= -1
    } else if (newTopPos > whaleHeight) {
      elem.style.top = whaleHeight
      whaleUpDirection *= -1
    } else {
      elem.style.top = newTopPos + "px"
    }




  }

  function moveSomething(e) {
    var elem = document.getElementById("myAnimation");  
    //console.log("up position", UpPos, "sidePos",sidePos);
    //console.log("window height", window.innerHeight,"window width",window.innerWidth);
      switch(e.keyCode) {
          case 37:
              // left key pressed

              if (sidePos - speed > - baresameWidth - speed)
                sidePos -=speed
              
              else
                sidePos= window.innerWidth - baresameWidth/2.
              elem.style.left = sidePos + 'px'; 
              break;

          case 38:
              // up key pressed
              if (UpPos - speed > -1 * baresameHeight)
                UpPos -=speed
              else
                UpPos = Math.floor(window.innerHeight - baresameHeight/2.);
                //UpPos = screen.height - baresameHeight
              elem.style.top = UpPos + 'px'; 
              break;
          case 39:
              // right key pressed
              if (sidePos + baresameWidth + speed < window.innerWidth)
                sidePos +=speed
              else
                sidePos = -baresameWidth

              elem.style.left = sidePos + 'px'; 
              break;
          case 40:
              // down key pressed
              
              if (UpPos + speed  > window.innerHeight - baresameHeight)
                UpPos = Math.floor(-baresameHeight * .8 - speed*2) 
              else
                UpPos +=speed
              elem.style.top = UpPos + 'px'; 
              break;  
      }   
  }


    //init is supposed to be called once and then i flip the initflag var/
    // this is me attempting to not load the image continously. it doesn't work
    // init is only called once but the image is loaded consecutively. 
    if (!initFlag)
    {
      init()

    }
    


var timer = setInterval(moveWhale, 50)



//<img src ="barewhale.png" alt="Computer man" style="width:753pxpx;height:1530px;">
//<img src ="both.png" alt="Computer man" style="width:753pxpx;height:1530px;">

// TODO:
// I want to make the movement fluid when the keyboard is pressed down contiune moving (Done)
// I want to add blocks so you can't move offscreen. (Done)
// I want to rotate the image.
// I want to introuduce the barewhale + collision + enemy. 
</script>

</body>
</html>


